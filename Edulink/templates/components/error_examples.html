{% comment %}
Error Display Examples Template
Demonstrates usage of the error display system across different scenarios
{% endcomment %}

{% load error_tags %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error Display Examples - EduLink</title>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Error handling dependencies -->
    {% error_dependencies %}
    
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 2rem;
            background-color: #f8fafc;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .example-section {
            background: white;
            border-radius: 0.75rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
        }
        
        .example-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #1e293b;
        }
        
        .example-description {
            color: #64748b;
            margin-bottom: 1.5rem;
        }
        
        .demo-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }
        
        .demo-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .demo-btn:hover {
            background: #1d4ed8;
        }
        
        .demo-btn--secondary {
            background: #64748b;
        }
        
        .demo-btn--secondary:hover {
            background: #475569;
        }
        
        .form-example {
            max-width: 500px;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #374151;
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .inline-error-container {
            min-height: 100px;
            border: 2px dashed #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .code-example {
            background: #f1f5f9;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.875rem;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>EduLink Error Display System Examples</h1>
        <p>This page demonstrates the comprehensive error display system with various use cases and configurations.</p>
        
        <!-- Toast Notifications -->
        <div class="example-section">
            <h2 class="example-title">Toast Notifications</h2>
            <p class="example-description">Toast notifications appear in the top-right corner and auto-dismiss after a few seconds.</p>
            
            <div class="demo-buttons">
                <button class="demo-btn" onclick="showInfoToast()">Info Toast</button>
                <button class="demo-btn" onclick="showSuccessToast()">Success Toast</button>
                <button class="demo-btn" onclick="showWarningToast()">Warning Toast</button>
                <button class="demo-btn" onclick="showErrorToast()">Error Toast</button>
                <button class="demo-btn" onclick="showCriticalToast()">Critical Toast</button>
            </div>
            
            <div class="code-example">
                <strong>JavaScript Usage:</strong><br>
                <code>window.ErrorHandler.showError({
    type: 'success',
    title: 'Operation Successful',
    message: 'Your changes have been saved.',
    displayType: 'toast'
});</code>
            </div>
        </div>
        
        <!-- Modal Errors -->
        <div class="example-section">
            <h2 class="example-title">Modal Error Dialogs</h2>
            <p class="example-description">Modal dialogs are used for critical errors that require user attention.</p>
            
            <div class="demo-buttons">
                <button class="demo-btn" onclick="showErrorModal()">Error Modal</button>
                <button class="demo-btn" onclick="showCriticalModal()">Critical Modal</button>
                <button class="demo-btn" onclick="showModalWithActions()">Modal with Actions</button>
            </div>
            
            <div class="code-example">
                <strong>JavaScript Usage:</strong><br>
                <code>window.ErrorHandler.showError({
    type: 'critical',
    title: 'System Error',
    message: 'A critical error has occurred.',
    details: 'Error code: 500 - Internal server error',
    displayType: 'modal',
    actions: [{
        text: 'Retry',
        action: () => location.reload()
    }]
});</code>
            </div>
        </div>
        
        <!-- Inline Errors -->
        <div class="example-section">
            <h2 class="example-title">Inline Error Messages</h2>
            <p class="example-description">Inline errors are displayed within the page content, perfect for form validation and contextual messages.</p>
            
            <div class="demo-buttons">
                <button class="demo-btn" onclick="showInlineError()">Show Inline Error</button>
                <button class="demo-btn" onclick="showInlineWarning()">Show Inline Warning</button>
                <button class="demo-btn" onclick="showInlineSuccess()">Show Inline Success</button>
                <button class="demo-btn--secondary demo-btn" onclick="clearInlineErrors()">Clear Errors</button>
            </div>
            
            <div class="inline-error-container" id="inline-container">
                <p><em>Inline errors will appear here...</em></p>
            </div>
            
            <!-- Template Tag Examples -->
            <h3>Template Tag Usage:</h3>
            
            {% error_display error_type="info" title="Information" message="This is an informational message using template tags." %}
            
            {% error_display error_type="warning" title="Warning" message="This is a warning message with details." details="Additional context about the warning." dismissible=True %}
            
            <div class="code-example">
                <strong>Django Template Usage:</strong><br>
                <code>{% verbatim %}{% load error_tags %}
{% error_display error_type="warning" title="Warning" message="This is a warning message." dismissible=True %}{% endverbatim %}</code>
            </div>
        </div>
        
        <!-- Form Validation -->
        <div class="example-section">
            <h2 class="example-title">Form Validation Errors</h2>
            <p class="example-description">Demonstrate form field validation with error highlighting and messages.</p>
            
            <form class="form-example" data-error-handling data-success-message="Form submitted successfully!">
                {% csrf_token %}
                <div class="form-group">
                    <label class="form-label" for="email">Email Address</label>
                    <input type="email" id="email" name="email" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="password">Password</label>
                    <input type="password" id="password" name="password" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="confirm_password">Confirm Password</label>
                    <input type="password" id="confirm_password" name="confirm_password" class="form-control" required>
                </div>
                
                <div class="demo-buttons">
                    <button type="button" class="demo-btn" onclick="simulateValidationErrors()">Show Validation Errors</button>
                    <button type="button" class="demo-btn" onclick="clearFormErrors()">Clear Errors</button>
                    <button type="submit" class="demo-btn">Submit Form</button>
                </div>
            </form>
            
            <div class="code-example">
                <strong>Form Error Handling:</strong><br>
                <code>// Show field-specific error
window.ErrorHandler.showFieldError(field, 'This field is required.');

// Clear field error
window.ErrorHandler.clearFieldError(field);</code>
            </div>
        </div>
        
        <!-- API Error Handling -->
        <div class="example-section">
            <h2 class="example-title">API Error Handling</h2>
            <p class="example-description">Demonstrate automatic API error handling with different response codes.</p>
            
            <div class="demo-buttons">
                <button class="demo-btn" onclick="simulateApiError(400)">400 Bad Request</button>
                <button class="demo-btn" onclick="simulateApiError(401)">401 Unauthorized</button>
                <button class="demo-btn" onclick="simulateApiError(403)">403 Forbidden</button>
                <button class="demo-btn" onclick="simulateApiError(404)">404 Not Found</button>
                <button class="demo-btn" onclick="simulateApiError(500)">500 Server Error</button>
                <button class="demo-btn" onclick="simulateNetworkError()">Network Error</button>
            </div>
            
            <div class="code-example">
                <strong>API Error Handling:</strong><br>
                <code>// Automatic error handling with fetch
apiRequest('/api/endpoint/', { method: 'POST', body: data })
    .then(response => response.json())
    .then(data => console.log('Success:', data))
    .catch(error => {
        // Errors are automatically handled by the error system
        console.log('Error handled automatically');
    });</code>
            </div>
        </div>
        
        <!-- Accessibility Features -->
        <div class="example-section">
            <h2 class="example-title">Accessibility Features</h2>
            <p class="example-description">The error system includes comprehensive accessibility features:</p>
            
            <ul>
                <li><strong>ARIA Live Regions:</strong> Screen readers are automatically notified of new errors</li>
                <li><strong>Keyboard Navigation:</strong> All interactive elements are keyboard accessible</li>
                <li><strong>Focus Management:</strong> Focus is properly managed in modal dialogs</li>
                <li><strong>High Contrast Support:</strong> Errors are visible in high contrast mode</li>
                <li><strong>Reduced Motion:</strong> Animations respect user preferences</li>
            </ul>
            
            <div class="demo-buttons">
                <button class="demo-btn" onclick="testAccessibility()">Test Screen Reader Announcement</button>
                <button class="demo-btn" onclick="testKeyboardNavigation()">Test Keyboard Navigation</button>
            </div>
        </div>
        
        <!-- Configuration -->
        <div class="example-section">
            <h2 class="example-title">Configuration Options</h2>
            <p class="example-description">The error system can be configured globally or per-error:</p>
            
            <div class="code-example">
                <strong>Global Configuration:</strong><br>
                <code>window.ERROR_CONFIG = {
    defaultTimeout: 5000,
    criticalTimeout: 0,
    maxToasts: 5,
    enableSounds: false,
    enableAnimations: true
};</code>
            </div>
            
            <div class="code-example">
                <strong>Per-Error Configuration:</strong><br>
                <code>window.ErrorHandler.showError({
    type: 'warning',
    title: 'Custom Configuration',
    message: 'This error has custom settings.',
    autoHide: 10000,  // 10 seconds
    persistent: true, // Survives page reloads
    dismissible: false
});</code>
            </div>
        </div>
    </div>
    
    <!-- Include API error handler -->
    {% api_error_handler %}
    
    <!-- JavaScript configuration -->
    {% error_js_config %}
    
    <!-- CSRF error handling -->
    {% csrf_error_handler %}
    
    <script>
        // Demo functions for examples
        function showInfoToast() {
            window.ErrorHandler.showInfo({
                title: 'Information',
                message: 'This is an informational message.',
                displayType: 'toast'
            });
        }
        
        function showSuccessToast() {
            window.ErrorHandler.showSuccess({
                title: 'Success!',
                message: 'Operation completed successfully.',
                displayType: 'toast'
            });
        }
        
        function showWarningToast() {
            window.ErrorHandler.showWarning({
                title: 'Warning',
                message: 'Please review your input before continuing.',
                displayType: 'toast'
            });
        }
        
        function showErrorToast() {
            window.ErrorHandler.showError({
                title: 'Error Occurred',
                message: 'Something went wrong. Please try again.',
                displayType: 'toast'
            });
        }
        
        function showCriticalToast() {
            window.ErrorHandler.showCritical({
                title: 'Critical Error',
                message: 'A critical system error has occurred.',
                details: 'Error code: CRIT_001 - System overload detected',
                displayType: 'toast'
            });
        }
        
        function showErrorModal() {
            window.ErrorHandler.showError({
                type: 'error',
                title: 'Operation Failed',
                message: 'The requested operation could not be completed.',
                details: 'Server returned HTTP 500: Internal Server Error',
                displayType: 'modal'
            });
        }
        
        function showCriticalModal() {
            window.ErrorHandler.showCritical({
                title: 'System Failure',
                message: 'A critical system failure has been detected.',
                details: 'Database connection lost. All unsaved changes may be lost.',
                actions: [{
                    text: 'Save & Reload',
                    action: () => {
                        alert('Saving data...');
                        setTimeout(() => location.reload(), 1000);
                    }
                }, {
                    text: 'Reload Now',
                    action: () => location.reload(),
                    secondary: true
                }]
            });
        }
        
        function showModalWithActions() {
            window.ErrorHandler.showError({
                type: 'warning',
                title: 'Unsaved Changes',
                message: 'You have unsaved changes that will be lost.',
                displayType: 'modal',
                actions: [{
                    text: 'Save Changes',
                    action: () => {
                        window.ErrorHandler.showSuccess({
                            title: 'Saved',
                            message: 'Your changes have been saved.'
                        });
                    }
                }, {
                    text: 'Discard Changes',
                    action: () => {
                        window.ErrorHandler.showInfo({
                            title: 'Discarded',
                            message: 'Changes have been discarded.'
                        });
                    },
                    secondary: true
                }]
            });
        }
        
        function showInlineError() {
            const container = document.getElementById('inline-container');
            window.ErrorHandler.showError({
                type: 'error',
                title: 'Validation Error',
                message: 'Please correct the errors below and try again.',
                details: 'Field validation failed for: email, password',
                displayType: 'inline',
                container: container
            });
        }
        
        function showInlineWarning() {
            const container = document.getElementById('inline-container');
            window.ErrorHandler.showWarning({
                title: 'Data Incomplete',
                message: 'Some optional fields are missing. You can continue or fill them now.',
                displayType: 'inline',
                container: container,
                actions: [{
                    text: 'Continue Anyway',
                    action: () => clearInlineErrors()
                }, {
                    text: 'Fill Missing Fields',
                    action: () => alert('Redirecting to form...'),
                    secondary: true
                }]
            });
        }
        
        function showInlineSuccess() {
            const container = document.getElementById('inline-container');
            window.ErrorHandler.showSuccess({
                title: 'Profile Updated',
                message: 'Your profile information has been successfully updated.',
                displayType: 'inline',
                container: container
            });
        }
        
        function clearInlineErrors() {
            const container = document.getElementById('inline-container');
            window.ErrorHandler.clearAllErrors(container);
            container.innerHTML = '<p><em>Inline errors will appear here...</em></p>';
        }
        
        function simulateValidationErrors() {
            const emailField = document.getElementById('email');
            const passwordField = document.getElementById('password');
            const confirmField = document.getElementById('confirm_password');
            
            window.ErrorHandler.showFieldError(emailField, 'Please enter a valid email address.');
            window.ErrorHandler.showFieldError(passwordField, 'Password must be at least 8 characters long.');
            window.ErrorHandler.showFieldError(confirmField, 'Passwords do not match.');
        }
        
        function clearFormErrors() {
            const fields = document.querySelectorAll('.form-control');
            fields.forEach(field => {
                window.ErrorHandler.clearFieldError(field);
            });
        }
        
        function simulateApiError(statusCode) {
            const error = new Error(`HTTP ${statusCode}`);
            error.response = {
                status: statusCode,
                statusText: getStatusText(statusCode),
                data: {
                    message: `Simulated ${statusCode} error`,
                    errors: statusCode === 400 ? { email: ['Invalid email format'] } : null
                }
            };
            
            window.ErrorHandler.handleApiError(error, {
                retryAction: () => alert('Retrying request...')
            });
        }
        
        function simulateNetworkError() {
            const error = new Error('Network request failed');
            error.request = true; // Indicates network error
            
            window.ErrorHandler.handleApiError(error, {
                retryAction: () => alert('Retrying request...')
            });
        }
        
        function getStatusText(status) {
            const statusTexts = {
                400: 'Bad Request',
                401: 'Unauthorized',
                403: 'Forbidden',
                404: 'Not Found',
                500: 'Internal Server Error'
            };
            return statusTexts[status] || 'Unknown Error';
        }
        
        function testAccessibility() {
            window.ErrorHandler.announceToScreenReader('This is a test announcement for screen readers.', true);
            window.ErrorHandler.showInfo({
                title: 'Accessibility Test',
                message: 'Screen reader announcement sent. Check your screen reader for the message.',
                displayType: 'toast'
            });
        }
        
        function testKeyboardNavigation() {
            window.ErrorHandler.showError({
                type: 'info',
                title: 'Keyboard Navigation Test',
                message: 'Try using Tab, Enter, and Escape keys to navigate this modal.',
                displayType: 'modal',
                actions: [{
                    text: 'First Button',
                    action: () => alert('First button clicked!')
                }, {
                    text: 'Second Button',
                    action: () => alert('Second button clicked!'),
                    secondary: true
                }]
            });
        }
    </script>
</body>
</html>