<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EduLink KE - Progress Report</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <link href="../assets/css/main.css" rel="stylesheet">
  <script src="../assets/js/main.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
    }
    .editable {
      cursor: pointer;
    }
    .editable:hover {
      background-color: #f0f0f0;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen">
  <!-- Top Header -->
  <div class="flex items-center justify-between px-6 py-4 bg-white shadow fixed top-0 left-0 right-0 z-30">
    <h2 class="text-2xl font-bold text-teal-800">EduLink KE</h2>
    <div class="flex items-center gap-4">
      <a href="#" class="bg-white shadow px-3 py-2 rounded-full text-sm">ðŸ’¬ Message</a>
      <button class="bg-white shadow px-3 py-2 rounded-full text-sm">ðŸ”” Notifications</button>
      <img src="https://via.placeholder.com/40" class="w-10 h-10 rounded-full" alt="Profile" />
    </div>
  </div>

  <!-- Sidebar Always Visible -->
  <aside class="fixed top-[4.5rem] left-0 w-64 bg-teal-800 text-white h-full p-6 z-20">
    <nav class="space-y-4 mt-2">
      <a href="./student_dash.html" class="block px-4 py-2 rounded hover:bg-teal-700">Dashboard</a>
      <a href="#" class="block px-4 py-2 rounded hover:bg-teal-700">Browse Internships</a>
      <a href="#" class="block px-4 py-2 rounded hover:bg-teal-700">Application Tracker</a>
      <a href="#" class="block px-4 py-2 rounded hover:bg-teal-700">My Internship</a>
      <a href="./profile.html" class="block px-4 py-2 rounded hover:bg-teal-700">Profile</a>
      <a href="./progress.html" class="block px-4 py-2 rounded hover:bg-teal-700">Reports and Logbooks</a>
      <a href="#" class="block px-4 py-2 rounded hover:bg-teal-700">CV & Toolkit</a>
      <a href="#" class="block px-4 py-2 rounded hover:bg-teal-700">Support</a>
      <a href="#" class="block px-4 py-2 rounded hover:bg-teal-700">Log Out</a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="ml-64 p-6 pt-24">
    <div class="mb-8">
      <h1 class="text-2xl font-semibold text-teal-800">Progress Report & Logbook</h1>
      <p class="text-sm text-gray-600">Track daily and weekly tasks, and supervisor feedback.</p>
    </div>

    <!-- Calendar and Daily Task Section -->
    <div id="calendar" class="bg-white p-4 shadow rounded mb-6 h-[600px]"></div>
    <div id="taskForm" class="bg-white p-4 shadow rounded hidden">
      <h2 class="text-lg font-bold mb-2">Add Task for <span id="selectedDate"></span></h2>
      <textarea id="taskText" class="w-full border rounded p-2 mb-2" placeholder="Describe the task..."></textarea>
      <select id="taskState" class="w-full border rounded p-2 mb-2">
        <option value="In Progress">In Progress</option>
        <option value="Completed">Completed</option>
      </select>
      <button onclick="saveTask()" class="bg-teal-600 text-white px-4 py-2 rounded hover:bg-teal-700">Update</button>
    </div>

    <!-- Weekly Progress Table -->
    <div class="overflow-x-auto mt-8">
      <table class="min-w-full bg-white shadow rounded">
        <thead class="bg-teal-800 text-white">
          <tr>
            <th class="px-4 py-2 text-left">Week</th>
            <th class="px-4 py-2 text-left">Activities Done</th>
            <th class="px-4 py-2 text-left">Feedback Status</th>
            <th class="px-4 py-2 text-left">Supervisor Comments</th>
          </tr>
        </thead>
        <tbody id="logbookTable" class="text-gray-700">
          <tr class="border-b">
            <td class="px-4 py-2">Week 1</td>
            <td class="px-4 py-2">Assisted with frontend bug fixes</td>
            <td class="px-4 py-2">Reviewed</td>
            <td class="px-4 py-2 editable" onclick="editComment(this)">Well documented setup</td>
          </tr>
          <tr class="border-b">
            <td class="px-4 py-2">Week 2</td>
            <td class="px-4 py-2">Configured backend authentication</td>
            <td class="px-4 py-2">Pending</td>
            <td class="px-4 py-2 editable italic text-gray-400" onclick="editComment(this)">Awaiting review</td>
          </tr>
        </tbody>
      </table>
    </div>

    <footer class="text-center text-sm text-gray-400 mt-16">
      &copy; 2025 EduLink KE. Empowering Students with Verified Internships.
    </footer>
  </main>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const calendarEl = document.getElementById('calendar');
    const taskForm = document.getElementById('taskForm');
    const selectedDateText = document.getElementById('selectedDate');
    const taskText = document.getElementById('taskText');
    const taskState = document.getElementById('taskState');
    let selectedDate = null;

  // ...existing code...
const calendar = new FullCalendar.Calendar(calendarEl, {
  initialView: 'dayGridWeek',      // Show only a week
  firstDay: 0,                     // Start week on Sunday
  height: 600,
  dateClick: function (info) {
    selectedDate = info.dateStr;
    selectedDateText.textContent = selectedDate;
    taskText.value = localStorage.getItem(`${selectedDate}_task`) || '';
    taskState.value = localStorage.getItem(`${selectedDate}_state`) || 'In Progress';
    taskForm.classList.remove('hidden');
  },
  events: loadStoredTasks(),
  eventContent: function(arg) {
    // Split by line breaks if present, or by ' (' for state
    const lines = arg.event.title.split('\n').map(line => {
      // If you want to split task and state, you can use:
      // return line.split(' (').join('<br>(');
      return line;
    });
    return { html: lines.join('<br>') };
  }
});
// ...existing code...

    calendar.render();

    window.saveTask = function () {
      if (!selectedDate) return;
      
      const task = taskText.value;
      const state = taskState.value;

      // Save to localStorage
      localStorage.setItem(`${selectedDate}_task`, task);
      localStorage.setItem(`${selectedDate}_state`, state);

      // Remove existing event for this date (if any)
      const existingEvents = calendar.getEvents();
      existingEvents.forEach(event => {
        if (event.startStr === selectedDate) {
          event.remove();
        }
      });

      // Add updated event
      calendar.addEvent({
        title: `${task}\n (${state})`,
        start: selectedDate,
        allDay: true
      });

      alert('Task updated and shown on calendar!');
    };

    function loadStoredTasks() {
      const events = [];
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.endsWith('_task')) {
          const date = key.replace('_task', '');
          const task = localStorage.getItem(key);
          const state = localStorage.getItem(`${date}_state`) || 'In Progress';
          events.push({
            title: `${task} (${state})`,
            start: date,
            allDay: true
          });
        }
      }
      return events;
    }

    window.editComment = function(cell) {
      const currentText = cell.textContent;
      const input = document.createElement('input');
      input.type = 'text';
      input.value = currentText;
      input.className = 'w-full px-2 py-1 border rounded';

      input.addEventListener('blur', () => {
        cell.innerHTML = input.value;
        cell.classList.remove('italic', 'text-gray-400');
      });

      cell.innerHTML = '';
      cell.appendChild(input);
      input.focus();
    }
  });
</script>

  
</body>
</html>
